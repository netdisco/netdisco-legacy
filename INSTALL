NAME

    INSTALL - Instructions for setting up Netdisco

AUTHOR

    Max Baker

REQUIREMENTS

    * Perl (5.6.1 and newer advised)
    * Perl Modules (see below)
    * Net-SNMP (5.0.2 and newer advised)
    * PostgreSQL (7.2 and newer advised)
    * Mason (1.14 or newer required)
    * Apache (1.3.x advised)
    * mod_perl (version to match Apache)
    * GraphViz
INSTALL

    1. Uncompress the netdisco archive
    2. Create a directory for netdisco
        Default /usr/local/netdisco

    3. Create a user and group for netdisco
        Default "netdisco / netdisco"

    4. Add Users who will be able to manage netdisco to the group created.
    5. Modify netdisco.conf to match your site.
        See README for detailed configuration descriptions.

    6. Follow the Instructions below for each required piece of software
    7. Try to discover a device with
        "./netdisco -d devicename"

    8. Once you're sure netdisco is setup correctly, add the CRON jobs by
    first modifying netdisco.crontab then as root :
        "cron -u netdisco netdisco.crontab"

  PostgreSQL

    The default settings for Postgres are

    Username: "netdisco" Database Name: "netdisco"

    1. [Optional] Change database name in sql/pg_init
    2. [Optional] Change database name in sql/pg_run
    3. Create Database.
        As root (or the database user pgsql) run "sql/pg_init" to create the
        database and user for Netdisco. The password you will be asked for
        twice is the new password for the database user you are creating.
        This is the same password you will be putting in
        netdisco_apache.conf and in netdisco.conf.

    4. Check Settings
        Now as a non-privledged user make sure you can get into the database
        by running "sql/pg_run". Enter the database user password created
        above.

    5. Create Tables
        Once you are sure the database is setup correctly, create the
        database tables with "sql/pg_all". Type in the database user
        password once when prompted.

    6. [Optional] Permissions
        If you have just setup postgresql, you may want to change the
        default permissions in data/pg_hba.conf :

  Apache

    1. Install Apache 1.3.x and mod_perl 1.x
        If you haven't installed apache and mod_perl before, below is the
        method I usually use to statically include mod_perl, but leave the
        rest of the modules as dynamically loadable objects (DSO).

        Download and unarchive
            http://httpd.apache.org and http://perl.apache.org

        in apache_1.3.x/
             ./configure 

            to setup directory scheme

        in mod_perl-1.2x/
             /usr/local/bin/perl Makefile.pl \
                    APACHE_SRC=../apache_1.3.27/src \
                    EVERYTHING=1 \
                    DO_HTTPD=1 \
                    USE_APACI=1 \
                    PREP_HTTPD=1

             make

        in apache_1.3.x/
             ./configure \
                    --prefix=/usr/local/apache \
                    --enable-module=most \
                    --enable-shared=max \
                    --activate-module=src/modules/perl/libperl.a \
                    --with-perl=/usr/local/bin/perl
             make
             make install

        in mod_perl-1.2x/
             make install

    2. Add in /your/apache/conf/httpd.conf
        In Each VirtualHost (SSL,Main...)
            "Include /usr/local/netdisco/netdisco_apache_dir.conf"

        In the Global Section
            "Include /usr/local/netdisco/netdisco_apache.conf"

    3. Permissions
        Assuming "nobody" is the user that your HTTP process run under, run
        this as "root" :

        "chown nobody.netdisco /usr/local/netdisco/mason"

    4. [Optional] In netdisco_apache.conf and netdisco_apache_dir.conf
        * Change the web and physical paths appropriately.
    Note: Some Linux distributions such as Redhat 6.x install mod_perl as a
    Dynamic Shared Object (DSO). This is known to be unstable, especially
    with Mason. Compile mod_perl statically into Apache.

   Apache2

    Until mod_perl 2.0 is released as stable, Mason will not run under
    Apache2. Netdisco will not run under Apache2 until that point.

  Perl and Mason

    Below is a list of required modules for Netdisco, freely available from
    CPAN (http://www.cpan.org). Many of these modules have pre-requisite
    modules. Use the CPAN module that comes with Perl to install the modules
    and their prerequisites automatically:

    "perl -MCPAN -e shell"

    install SNMP::Info
    install Time::HiRes
    install DBI
    install DBD::Pg
    install Apache::DBI
    install Storable
    install Apache::Session
    install Apache::Request
    install HTML::Mason
    install MasonX::Request::WithApacheSession
    install Graph
    install GraphViz (optional)
    Some of these you will probably already have installed.

  SNMP

    1. Download and install net-snmp from http://net-snmp.sourceforge.net
    2. Install SNMP Perl module that comes inside the distribution.
    3. Run "snmpconf" and set up your MIB directory.
        (Default /usr/local/share/snmp/mibs)

        Make sure this new snmp.conf lives in /usr/local/share/snmp

   MIBs

    MIBs are required for SNMP::Info.

    1. Get MIBS from:
        ftp://ftp.cisco.com/pub/mibs/v1/v1.tar.gz
        ftp://ftp.cisco.com/pub/mibs/v2/v2.tar.gz
        http://www.hp.com/rnd/software/MIBs.htm
    2. Install to /usr/local/share/snmp/mibs
  OUI

    The Organizationally Unique Identifier (OUI) database allows Netdisco to
    identify the manufacture of a network card using the first 24 bits of a
    MAC address. The database is available from the IEEE.

    1. Download oui.txt from http://standards.ieee.org/regauth/oui/
    2. Run "netdisco -O"
  GraphViz (optional)

    GraphViz is used in the creation of the Network Map and is an optional
    feature. Note that if you choose not to install GraphViz, you still need
    to install the Graph module (see Perl above).

    1. Download and install the newest version from
    http://www.graphviz.org/pub/graphviz
        If you run BSD: "cd /usr/ports/graphics/graphviz && make install"

    2. Copy a True Type Font file (.ttf) into this directory and change
    "node_font" in netdisco.conf to match.
    3. Review other graph settings in netdisco.conf
